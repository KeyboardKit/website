{% if jekyll.environment == "production" %}
{%- if site.google-analytics.measurement-id -%}
  {% assign id = site.google-analytics.measurement-id %}
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id={{id}}"></script>
  <script>
    // Only initialize GA on canonical HTTPS non-www URL
    const isHttps = window.location.protocol === 'https:';
    const isNonWww = !window.location.hostname.startsWith('www.');
    
    if (isHttps && isNonWww) {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'YOUR-GA-ID');
    }
  </script>
{%- endif -%}
{%- endif -%}